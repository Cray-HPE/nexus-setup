#!/bin/bash

# Copyright 2020 Hewlett Packard Enterprise Development LP

. "$(dirname "$0")/nexus-ready"

# requires the setup_capability script

echo -n >&2 "Enable Rut Auth..."

curl -sfk -w "%{http_code}" -X POST \
    "${URL}/v1/script/setup_capability/run" \
    -H "Content-Type: application/json" \
    -d '{"capability_typeId": "rutauth", "capability_enabled": true, "capability_properties": {"httpHeader": "X-WEBAUTH-USER"}}'
status=$?

if [[ $status -eq 0 ]]; then echo >&2 " OK"; else echo >&2 " FAIL"; exit $status; fi
